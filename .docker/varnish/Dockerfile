########################################################################################################################
ARG     ALPINE_VERSION="${ALPINE_VERSION:-3.8}"
FROM    alpine:${ALPINE_VERSION}
########################################################################################################################
LABEL   Maintainer  =   "Haseeb Memon <memon.haseeb@hotmail.com>"
LABEL   Description =   "varnish container for magento"
########################################################################################################################
RUN apk --update --no-cache add varnish
########################################################################################################################
#Copy custom configs to container
COPY .docker/varnish/conf/default.vcl /etc/varnish/default.vcl
########################################################################################################################
#Copy shell executable script to container
COPY .docker/varnish/bin/startup.sh /usr/local/bin/startup.sh
RUN ["chmod", "+x", "/usr/local/bin/startup.sh"]
########################################################################################################################
# Expose Ports
EXPOSE 80
########################################################################################################################
WORKDIR /var/lib/varnish
########################################################################################################################
CMD [ "sh", "/usr/local/bin/startup.sh" ]
